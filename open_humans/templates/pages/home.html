{% extends 'base.html' %}

{% load static from staticfiles %}
{% load utilities %}

{% block head_title %}Home{% endblock %}

{% block extra_js %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.0/imagesloaded.pkgd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/2.2.2/isotope.pkgd.min.js"></script>
{% endblock %}

{% block body_main %}

{% if not user.is_authenticated %}
<div class="call-to-action-1">
  <div class="container">

    <h1>Open Humans</h1>

    <h4 class="subtitle">
      Participate&nbsp;in&nbsp;research. Share&nbsp;your&nbsp;data. Learn&nbsp;more&nbsp;together.
    </h4>

    <p class="subsubtitle small">
      A free program of the nonprofit
      <a href="http://openhumansfoundation.org/">Open&nbsp;Humans&nbsp;Foundation</a>
    </p>

    <div style="margin-bottom:45px;">
      <a class="btn btn-lg btn-primary signup-link"
        href="{% url 'account_signup' %}">Join now!</a>

      <a class="btn btn-lg btn-default login-link"
        href="{% url 'account_login' %}">Log in</a>
    </div>

    <div class="row">
      <div class="col-sm-4 text-center">
        <div class="row">
          <div class="col-xs-4 visible-xs">
            <img class="img-circle img-responsive img-center cta-1-profile-xs"
              src="{% static 'images/Joshua-Berk.jpg' %}" alt="">
          </div>
          <div class="col-xs-8 col-sm-12">
            <img class="img-circle img-responsive img-center hidden-xs cta-1-profile-sm"
              src="{% static 'images/Joshua-Berk.jpg' %}" alt="">
              <div class="cta-1-profile-quote">
              <h4>Joshua Berk<br>
                <small style="color:#bbb;">Health-tracking Enthusiast</small>
              </h4>
              <p>
                "I believe the benefits to research from Open Humans &ndash;
                especially as the data set becomes even larger and more statistically
                significant – will be enormous."
              </p>
              <p class="text-right small">
                <a href="https://blog.openhumans.org/2016/06/20/spotlight-on-a-participant-joshua-berk/"
                  style="color:#9999ff">
                  Read more...
                </a>
              </p>
            </div>
          </div>
        </div>
      </div>

      <div class="col-sm-4 text-center">
        <div class="row">
          <div class="col-xs-4 visible-xs">
            <img class="img-circle img-responsive img-center cta-1-profile-xs"
              src="{% static 'images/Liz-Salmi.jpg' %}" alt="">
          </div>
          <div class="col-xs-8 col-sm-12">
            <img class="img-circle img-responsive img-center hidden-xs cta-1-profile-sm"
              src="{% static 'images/Liz-Salmi.jpg' %}" alt="">

            <div class="cta-1-profile-quote">
              <h4>Liz Salmi<br>
                <small style="color:#bbb;">Patient&nbsp;Advocate &amp; Brain&nbsp;Cancer&nbsp;Blogger</small>
              </h4>

              <p>
                "It's a very personal choice to share health information. What is
                right for me isn't necessarily right for everyone."
              </p>
              <p class="text-right small">
                <a href="https://blog.openhumans.org/2016/09/11/spotlight-on-a-participant-liz-salmi/"
                  style="color:#9999ff">
                  Read more...
                </a>
              </p>
            </div>
          </div>
        </div>
      </div>

      <div class="col-sm-4 text-center">
        <div class="row">
          <div class="col-xs-4 visible-xs">
            <img class="img-circle img-responsive img-center cta-1-profile-xs"
              src="{% static 'images/James-Turner.jpg' %}" alt="">
          </div>
          <div class="col-xs-8 col-sm-12">
            <img class="img-circle img-responsive img-center hidden-xs cta-1-profile-sm"
              src="{% static 'images/James-Turner.jpg' %}" alt="">

            <div class="cta-1-profile-quote">
              <h4>James Turner<br>
                <small style="color:#bbb;">Citizen&nbsp;Scientist &amp; Project&nbsp;Creator</small>
              </h4>

              <p>
                "Because the researchers and participants have a much more
                collaborative attitude than the typical research project, you really
                feel like you’re a part of the science, not just another anonymized
                identifier in a database."
              </p>
              <p class="text-right small">
                <a href="https://blog.openhumans.org/2016/08/14/spotlight-on-a-participant-james-turner/"
                  style="color:#9999ff">
                  Read more...
                </a>
              </p>
            </div>
          </div>
        </div>
      </div>

    </div> <!-- /row -->
  </div> <!-- /container -->
</div> <!-- /call-to-action-1 -->
<div class="call-to-action-2">
  <div class="container">
    {% include 'pages/about-main-content.html' %}
  </div>
</div>
<div class="call-to-action-4">
  <div class="container">
    {% include 'pages/about-main-content-2.html' %}
  </div>
</div>
{% endif %}

{% if user.is_authenticated and not user.member.primary_email.verified %}
<div class="call-to-action-3">
  <div class="container">
    <h3>Please verify your email address.</h3>
    <p>
      Welcome to Open Humans! Being able to contact you is very important.
      When you can connect to studies and import data, we want to be sure we
      have a correct email address.
    </p>
    <ul>
      <li>
        <b>Check your email</b><br>
        Our email contains a link that verifies your address. The message
        should be titled:<br>
        <p style="margin-left:20px;">
          {% include 'account/email/email_confirmation_subject.txt' %}
        </p>
      </li>
      <li>
        <b>Resend verification message</b><br>
        <a href="{% url 'my-member-send-confirmation-email' %}?next={% url 'home' %}">
        Click here to send a new verification email</a>
        to your email address.
        </a>
      </li>
    </ul>
    <p>
      The email address we have for you is
      <b>"{{ user.member.primary_email.email }}"</b>. If this is incorrect,
      you can change it on <a href="{% url 'my-member-settings' %}">your
      account settings page</a>.
    </p>
  </div>
</div>
{% endif %}

<div class="container anchor-tag" id="activities-list">
  {% block messages_block %}
    {% if messages %}
    <div class="row">
      {% for message in messages %}
      <div{% if message.tags %} class="message {{ message.tags }}"{% endif %}>
        {{ message }}</div>
      {% endfor %}
    </ul>
    {% endif %}
  {% endblock messages_block %}
  <div class="row">
    <div class="col-md-12 toolbar-column">
      <div class="btn-toolbar pull-left" role="toolbar">
        <div class="btn-group filters" role="group">
          <button type="button" class="btn btn-default btn-sm selected"
            data-filter="*">All activities</button>

          {% if user.is_authenticated %}
          <button type="button" class="btn btn-default btn-sm"
            data-filter=".data-source:not(.connected)">Connect data</button>

          <button type="button" class="btn btn-default btn-sm"
            data-filter=".share-data:not(.connected)">Join projects</button>

          <button type="button" class="btn btn-default btn-sm"
            data-filter=".connected">Connected&nbsp;&amp;&nbsp;Joined</button>
          {% else %}
          <button type="button" class="btn btn-default btn-sm"
            data-filter=".data-source">Connect data</button>

          <button type="button" class="btn btn-default btn-sm"
            data-filter=".share-data">Join projects</button>
          {% endif %}
        </div>
      </div>

      <div class="pull-right toolbar-text">
        <div class="filter-description" data-filter="*">
          Contribute to science! Connect data, join projects, and share.
        </div>

        <div class="filter-description" data-filter=".data-source">
          Members can add data from the following data sources.
        </div>

        <div class="filter-description" data-filter=".share-data">
          Members can contribute to these studies and projects.
          (<a href="{% url 'direct-sharing:overview' %}">Learn about creating
            projects.</a>)
        </div>

        <div class="filter-description"
          data-filter=".data-source:not(.connected)">
          These are potential data sources for your profile. See anything to add?
        </div>

        <div class="filter-empty" data-filter=".data-source:not(.connected)">
          You've already connected all of the data sources!
        </div>

        <div class="filter-description"
          data-filter=".share-data:not(.connected)">
          Contribute to these studies and projects!

          (<a href="{% url 'direct-sharing:overview' %}">Learn about creating
            projects.</a>)
        </div>

        <div class="filter-empty" data-filter=".share-data:not(.connected)">
          Congrats, you've already joined all of the active projects!

          (<a href="{% url 'direct-sharing:overview' %}">Learn about creating
            your own projects.</a>)
        </div>

        <div class="filter-description" data-filter=".connected">
          You've connected these data sources and joined these projects &ndash; congrats!
        </div>

        <div class="filter-empty" data-filter=".connected">
          Looks like you haven't connected any data sources or sharing activities
          yet!
        </div>
      </div>
    </div>
  </div>

  <div class="grid row">
    {% for activity in activities %}
    <div id="activity-{{ activity.source_name|slugify }}"
      class="item col-xs-12 col-sm-6 col-md-4 {{ activity.classes }}">
      <div class="panel panel-default">
        <div class="panel-body">
          <div class="row">
            <div class="col-xs-3 col-sm-4 clearfix">
              {% badge activity.badge %}
            </div>

            <div class="col-xs-9 col-sm-8 description">
              <div>
                <span class="h4 name">{{ activity.verbose_name }}</span>
              </div>

              {% if activity.leader %}
              <div class="leader">
                {{ activity.leader}}
                {% if activity.organization %}
                <div class="organization">
                  <small class="text-muted">
                    {{ activity.organization }}
                  </small>
                </div>
                {% endif %}
              </div>
              {% endif %}


              <div class="connected-members">
                <small>
                {{ activity.connect_verb|title }}ed by
                <b><span class="members">
                  {{ activity.members|default:'0' }}
                </span></b>
                members
                </small>
              </div>

            </div>
          </div>

          <p class="activity-description">
            {{ activity.description }}
          </p>

          <hr>

          <center>
            {% if activity.is_connected %}
              {% if activity.has_files %}
              <a {% if activity.url_slug %}
                  href="{% url 'activity-management' activity.url_slug %}"
                  {% else %}
                  href="{{ activity.join_url }}"
                  {% endif %} class="btn btn-xs btn-default">
                Manage your data
              </a>
              {% else %}
              <span class="lead">{{ activity.connect_verb|title }}ed!</span><br>
              <span class="joined-subtext text-muted">
                Manage this connection on the
              <a {% if activity.url_slug %}
                  href="{% url 'activity-management' activity.url_slug %}"
                  {% else %}
                  href="{{ activity.join_url }}"
                  {% endif %}>
                activity page</a>.
              {% endif %}
            {% else %}
              <a {% if activity.url_slug %}
                  href="{% url 'activity-management' activity.url_slug %}"
                  {% else %}
                  href="{{ activity.join_url }}"
                  {% endif %}
                  class="btn btn-primary btn-xs">
                <b>Learn more</b>
              </a>
            {% endif %}
          </center>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>

</div> <!-- container -->
{% endblock %}
